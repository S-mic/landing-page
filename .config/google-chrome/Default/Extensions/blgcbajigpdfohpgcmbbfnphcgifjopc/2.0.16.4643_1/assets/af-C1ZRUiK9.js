import"./modulepreload-polyfill-xVUEmHkd.js";import{_ as B,d as ne}from"./_plugin-vue_export-helper-DbWluJVK.js";import{u as K,c as q,a as oe,f as le}from"./unhandledErrorHandler-Bxfeq5I8.js";import{i as ie}from"./i18n-DOZcdwWT.js";import{U as P,V as G,a0 as v,W as a,X as u,Y as m,_ as T,Z as e,a2 as f,a9 as F,ao as ue,$ as M,a3 as z,aC as X,a8 as W,a6 as H,ai as V,O as re,aL as ce,a4 as L,ae as de,e as me,b as J,aM as pe,aN as ee,aO as ge,aP as ve,a1 as ye,aQ as fe,aR as we,aS as _e,aG as he,aT as ke,aU as Ie,aV as Y,aW as Ce}from"./Settings-Bqkr9m9-.js";import{a as be,c as Se,b as Le}from"./autofillFunctions-CVxus-se.js";import{k as Z,a as Te,L as $,c as Ae}from"./CardListItem-DEPKb1tk.js";import{W as Ee}from"./WebsiteIcon-DpK2IMEY.js";import{i as Oe}from"./isVisible-D3ksDT_w.js";import{S as ae,P as Ne,_ as Ue}from"./PasswordStrengthFeedback.vue_vue_type_script_setup_true_lang-Cngq_PAD.js";import{u as We,S as He,P as Me}from"./Slider-BAhI-a85.js";import{A as D}from"./types-DUgExzQo.js";const Pe={class:"locked-vault"},Ge={class:"header"},Re={class:"message"},De=B(P({__name:"LockedVault",setup(S){const{t:p}=G(),r=K(),l=v(()=>p("pwm_locked_vault_unlock.message",{COMMAND:r.openCommand}));return(c,i)=>(a(),u("div",Pe,[m("div",Ge,[m("h6",null,T(e(p)("pwm_locked_vault_password_manager.message")),1)]),m("div",Re,[m("p",null,T(e(l)),1)])]))}}),[["__scopeId","data-v-7d86c69a"]]),Ve={class:"info"},Fe={class:"title"},ze={class:"subtitle"},Be=P({__name:"TotpListItem",props:{document:{}},setup(S){const{t:p}=G(),r=f(),l=S,c=f(null),i=f(),g=async()=>{var s;i.value=c.value!==null&&Oe(c.value),((s=r.value)==null?void 0:s.timerId)===void 0&&await Te({type:"gettotp",uuid:l.document.uuid},r,c.value),i.value||Z(r)};return document.addEventListener("scroll",s=>{g()},{capture:!0}),F(async()=>{g()}),ue(()=>{Z(r)}),(s,w)=>{var h;return a(),u("div",{class:"item-wrapper",ref_key:"loginItemEl",ref:c},[M(Ee,{title:s.document.title,domain:s.document.domain},null,8,["title","domain"]),m("div",Ve,[m("div",Fe,T(s.document.title),1),m("div",ze,T(e(p)("pwm_2fa_popup_subtitle.message",{CODE:((h=e(r))==null?void 0:h.code)??""})),1)])],512)}}}),qe={class:"autofill-suggestions"},xe={key:0},Qe=m("button",{class:"add"},null,-1),Ye=["innerHTML"],Ze={key:1,id:"domainEntries"},$e=["innerHTML"],j=P({__name:"AutofillLoginSuggestions",props:{url:{},frameId:{},itemType:{}},emits:["fillInputs","showAutofillWarning"],setup(S,{emit:p}){const{t:r}=G(),l=q(),c=f(),i=f({}),g=f(!1),s=S,w=p,h=v(()=>l.documents!==void 0),d=v(()=>{var t;return((t=l.documents)==null?void 0:t.filter(N=>N.type==="login"))??[]}),C=v(()=>[...d.value].sort((t,N)=>t.title.localeCompare(N.title,[],{sensitivity:"base"}))),k=v(()=>de(C.value,s.url.href,i.value)),b=v(()=>k.value.matchingHostname.map(t=>({...t,matching:"hostname"}))),A=v(()=>k.value.matchingDomain.map(t=>({...t,matching:"domain"}))),U=v(()=>b.value.concat(A.value)),E=f(),n=v(()=>b.value.length>0),o=v(()=>A.value.length>0),_=v(()=>{var t;return s.itemType==="totp"&&(((t=E.value)==null?void 0:t.length)??0)>0}),I=v(()=>r("no_logins_saved_for_website.message",{HOST:me(s.url.host)})),O=async t=>{const N=await l.getEntryPassword(t.uuid),y=await J([t.uuid]),R={...t,password:N,totp:y.code};pe(s.url,t,i.value)?(Q=>{const se=ve(Q.domain,s.url);w("showAutofillWarning",{document:Q,isInsecureWarning:se})})(R):w("fillInputs",t,s.itemType)};F(()=>{chrome.tabs.query({active:!0,currentWindow:!0},t=>{c.value=t[0].id}),x(),chrome.runtime.onMessage.addListener(t=>{t.action==="checkIfFormDirty"&&x()}),be().then(t=>{i.value=t})});const x=()=>{Se().then(t=>{g.value=t})},te=()=>{re(c.value,s.frameId),ce(c.value,s.frameId)};return s.itemType==="totp"&&z(U,async t=>{const N=await new ee().readAny("selectedLoginUuid"),y=await ge(t,N);E.value=y},{immediate:!0}),(t,N)=>(a(),u("div",qe,[e(h)?(a(),u(W,{key:1},[e(g)&&s.itemType!=="totp"?(a(),u("div",{key:0,id:"addNewEntry",onClick:te},[Qe,m("span",null,T(e(r)("autofill_add_new_entry.message")),1)])):H("",!0),s.itemType==="totp"?(a(),u(W,{key:1},[e(_)?(a(!0),u(W,{key:0},V(e(E),y=>(a(),L(Be,{class:"documents-list-item","data-test":"totp-item",key:y.uuid,document:y,onClick:R=>O(y)},null,8,["document","onClick"]))),128)):(a(),u("p",{key:1,innerHTML:e(I)},null,8,Ye))],64)):s.itemType==="login"?(a(),u(W,{key:2},[e(n)?(a(!0),u(W,{key:0},V(e(b),y=>(a(),L($,{class:"documents-list-item",key:y.uuid,document:y,onClick:R=>O(y)},null,8,["document","onClick"]))),128)):H("",!0),e(o)?(a(),u("div",Ze)):H("",!0),(a(!0),u(W,null,V(e(A),y=>(a(),L($,{class:"documents-list-item",key:y.uuid,document:y,onClick:R=>O(y)},null,8,["document","onClick"]))),128)),e(n)||e(o)||e(g)?H("",!0):(a(),u("p",{key:2,innerHTML:e(I)},null,8,$e))],64)):H("",!0)],64)):(a(),u("p",xe,[X(T(e(r)("autofill_loading_login_documents.message"))+" ",1),M(ae)]))]))}}),je={class:"autofill-suggestions"},Ke={key:0},Xe=B(P({__name:"AutofillCardSuggestions",props:{url:{}},emits:["fillInputs"],setup(S,{emit:p}){const{t:r}=G(),l=q(),c=p,i=S,g=v(()=>l.documents!==void 0),s=v(()=>(l.documents??[]).filter(w=>w.type==="card"));return(w,h)=>(a(),u("div",je,[e(g)?(a(!0),u(W,{key:1},V(e(s),d=>(a(),L(Ae,{class:"documents-list-item",key:d.uuid,document:d,"icon-size":"sm","is-parent-popup":!1,onClick:C=>(k=>{confirm(r("autofill_card_suggestions_confirmation.message",{HOSTNAME:i.url.hostname}))&&c("fillInputs",k)})(d)},null,8,["document","onClick"]))),128)):(a(),u("p",Ke,[X(T(e(r)("autofill_loading_card_documents.message")),1),M(ae)]))]))}}),[["__scopeId","data-v-64b071aa"]]),Je={class:"password-wrapper"},ea={class:"password-label"},aa={class:"label"},ta=["innerHTML"],sa={class:"buttons"},na={key:0,class:"advanced-generator","data-test":"advanced-generator"},oa={class:"mb-20 mt-10",id:"passwordLength"},la=B(P({__name:"PasswordGeneratorAutofill",props:{category:{},frameId:{}},setup(S){const{t:p}=G(),{passwordStrength:r,generatePassword:l,recipe:c,generatedPassword:i,handleLengthChange:g,handleCriteriaChange:s}=We(),w=S,h=f(null),d=f(null),C=f(),k=f(!1),b=f(),A=v(()=>{var o;return(o=r.value)==null?void 0:o.score}),U=v(()=>we(i.value));F(()=>{chrome.tabs.getCurrent(o=>{C.value=o})}),z(h,o=>{const _=new ResizeObserver(I=>{var O;b.value=(O=h.value)==null?void 0:O.clientHeight});o&&(b.value=o.clientHeight,_.observe(o))}),z(b,(o,_)=>{var I;if((I=C.value)!=null&&I.id&&o&&_){const O=o-_;_e(C.value.id,w.frameId,{heightIncrease:O})}});const E=()=>{var o;((o=C.value)==null?void 0:o.id)!==void 0&&w.category!==void 0&&fe(C.value.id,w.frameId,{category:w.category,password:i.value})},n=()=>{k.value=!k.value};return(o,_)=>(a(),u("div",{class:"autofill-password-generator",ref_key:"autofillEl",ref:d},[M(Ne,{score:e(A),type:"entry"},null,8,["score"]),m("div",Je,[m("div",ea,[m("div",aa,T(e(p)("password_generator_password_label.message")),1),m("div",{class:"password",innerHTML:e(U),onClick:E,"data-test":"generated-password",ref_key:"passwordEl",ref:h},null,8,ta)]),m("div",sa,[m("div",{class:"icon refresh",onClick:_[0]||(_[0]=(...I)=>e(l)&&e(l)(...I)),"data-test":"generate-password"}),m("div",{class:ye(["icon open-advanced-generator",{open:e(k)}]),onClick:n,"data-test":"toggle-advanced"},null,2)])]),e(k)?(a(),u("div",na,[M(Ue,{class:"mt-5",passwordStrength:e(r),keypathEmptyLabel:"primary_password_strength_empty"},null,8,["passwordStrength"]),m("div",oa,[M(He,{value:e(c).length,min:8,max:55,onInput:e(g)},null,8,["value","onInput"]),m("span",null,T(e(c).length),1)]),M(Me,{mustContainUppercase:e(c).mustContainUppercase,mustContainNumber:e(c).mustContainNumber,mustContainSymbol:e(c).mustContainSymbol,onChange:e(s)},null,8,["mustContainUppercase","mustContainNumber","mustContainSymbol","onChange"])])):H("",!0)],512))}}),[["__scopeId","data-v-62a92704"]]),ia=["login","card"],ua={class:"autofill-wrapper"},ra=P({__name:"AutofillWrapper",setup(S){const p=f(void 0),r=K(),l=q(),c=v(()=>l.isVaultUnlocked),i=f(),g=new URLSearchParams(window.location.search),s=g.get("category"),w=(h=s,ia.includes(h)?s:void 0);var h;const d=parseInt(g.get("frameId"),10),C=g.get("type")===D.PASSWORD_GENERATOR,k=g.get("type")===D.CARD_SUGGESTIONS,b=g.get("type")===D.LOGIN_SUGGESTIONS,A=g.get("type")===D.TOTP_SUGGESTIONS;async function U(n){switch(n.type){case"login":{const o=await l.getEntryPassword(n.uuid),_=await J([n.uuid]);Y(i.value,d,{document:{...n,password:o,totp:_.code}});const I=new ee;b&&I.writeAny("selectedLoginUuid",n.uuid),A&&I.removeItem("selectedLoginUuid");break}case"card":{const{cardNumber:o,securityCode:_}=await l.getCardBody(n.uuid);await Y(i.value,d,{document:{...n,cardNumber:o,securityCode:_}});break}}}async function E({document:n,isInsecureWarning:o}){n.type==="login"&&await Ce(i.value,d,{document:n,isInsecureWarning:o})}return he(()=>{l.getDocuments(),l.checkAccountStatus(),l.checkVaultLockStatus(),r.setBrowserInfo()}),F(async()=>{if(chrome.tabs.query({active:!0,currentWindow:!0},n=>{i.value=n[0].id}),d>=0){const n=await Le([d]);n&&(p.value=new URL(n))}i.value&&p.value&&(ke(i.value,d,{height:document.body.scrollHeight}),new ResizeObserver(n=>{Ie(i.value,d,{height:n[0].target.clientHeight})}).observe(document.body))}),chrome.runtime.onMessage.addListener(async n=>{n.action==="checkVaultLockStatus"&&l.checkVaultLockStatus()}),(n,o)=>(a(),u("div",ua,[e(c)&&e(p)?C?(a(),L(la,{key:1,category:e(w),frameId:e(d)},null,8,["category","frameId"])):k?(a(),L(Xe,{key:2,url:e(p),onFillInputs:U},null,8,["url"])):b?(a(),L(j,{key:3,url:e(p),frameId:e(d),"item-type":"login",onFillInputs:U,onShowAutofillWarning:E},null,8,["url","frameId"])):A?(a(),L(j,{key:4,url:e(p),frameId:e(d),"item-type":"totp",onFillInputs:U,onShowAutofillWarning:E},null,8,["url","frameId"])):H("",!0):(a(),L(De,{key:0}))]))}});oe("autofill"),ne(ra).use(ie).use(le()).mount("#app");
