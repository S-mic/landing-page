import{_ as O,a as H}from"./_plugin-vue_export-helper-DbWluJVK.js";import{W as ue}from"./WebsiteIcon-DpK2IMEY.js";import{a as me,i as _e}from"./isVisible-D3ksDT_w.js";import{u as q,g as ve,c as F,b as Q}from"./unhandledErrorHandler-Bxfeq5I8.js";import{U,a2 as g,a0 as S,a3 as ye,a9 as ee,ac as we,W as m,X as b,ak as ge,a1 as R,Z as o,aB as fe,V as j,Y as _,_ as T,aa as te,ab as oe,b as ae,a_ as be,ao as he,$ as C,h as ke,a6 as f,a4 as z,a5 as ie,v as Y,z as Ce,G as xe,P as Te,al as se,a$ as Ie}from"./Settings-Bqkr9m9-.js";const ne=O(U({__name:"Popover",props:{direction:{default:"left"},targetElement:{}},emits:["update:showSelf","hide"],setup(a,{emit:c}){const s=q(),v=c,t=a,n=g(),d=g(t.direction),x=S(()=>{let e=[];switch(d.value){case"left":e.push("popover-arrow-top","popover-arrow-left");break;case"topLeft":e.push("popover-arrow-bottom","popover-arrow-left");break;case"topRight":e.push("popover-arrow-bottom","popover-arrow-right");break;case"right":e.push("popover-arrow-top","popover-arrow-right")}return e}),k=S(()=>{var y;const e=((y=t.targetElement)==null?void 0:y.getBoundingClientRect())??null;let r={};if(e)switch(d.value){case"left":r={left:e.left+e.width-222+"px",top:`${e.bottom}px`};break;case"topLeft":r={left:e.left+e.width-222+"px",bottom:`${600-e.bottom+e.height+5}px`};break;case"right":r={left:`${e.left}px`,top:`${e.bottom}px`};break;case"topRight":r={left:`${e.left}px`,bottom:`${600-e.bottom+e.height+15}px`}}return r}),l=()=>{v("hide")};return document.addEventListener("wheel",()=>{d.value!=="left"&&l()}),ye(s,e=>{var r;e.popoverUid!==void 0&&e.popoverUid!==((r=n.value)==null?void 0:r.uid)&&v("hide")}),ee(()=>{var y,I;n.value=we(),s.popoverUid=(y=n.value)==null?void 0:y.uid;const e=((I=t.targetElement)==null?void 0:I.getBoundingClientRect())??null,r=e&&e.top>300;if(e&&t.direction&&r)switch(t.direction){case"left":d.value="topLeft";break;case"right":d.value="topRight"}}),(e,r)=>(m(),b("div",{class:R(["popover popover-arrow",o(x)]),onMouseleave:l,style:fe(o(k))},[ge(e.$slots,"content",{},void 0,!0)],38))}}),[["__scopeId","data-v-47a8f2ce"]]),Pe=(a=>(te("data-v-870d8d87"),a=a(),oe(),a))(()=>_("div",{class:"showBorder"},null,-1)),Se=["id"],Le={class:"title"},h=O(U({__name:"CreateDocumentOptionItem",props:{option:{}},setup(a){const{t:c}=j(),s=a,v=t=>{t.stopPropagation(),s.option.callback&&s.option.callback(t)};return(t,n)=>(m(),b("div",{class:R(["create-document-option",t.option.cssClass])},[Pe,_("div",{class:"item-wrapper",onClick:v,id:t.option.id},[_("div",Le,T(o(c)(t.option.title)),1),_("div",{class:R(["icon",t.option.icon])},null,2)],8,Se)],2))}}),[["__scopeId","data-v-870d8d87"]]),Z=a=>{var c,s;(c=a.value)!=null&&c.timerId&&(a.value.kill=!0,clearTimeout((s=a.value)==null?void 0:s.timerId)),a.value=void 0},W=async(a,c,s)=>{var v,t;if((v=c.value)!=null&&v.timerId&&window.clearTimeout(c.value.timerId),!((t=c.value)!=null&&t.kill)&&(s===void 0||s!==null&&(s===null||me(s))))try{await async function(n,d,x){if(n.value===void 0||n.value.expirySeconds<=1){let k,l=0;k=d.type==="generate"?await ve({totp:d.secret}):await ae([d.uuid]),l=be(k.expiry),n.value={code:k.code,expirySeconds:l}}else n.value.expirySeconds-=1;n.value!==void 0&&(n.value.timerId=window.setTimeout(W,1e3,d,n,x))}(c,a,s)}catch{c.value&&(c.value.timerId=window.setTimeout(W,1e3,a,c,s))}},Ee={class:"info"},Be={class:"title"},De={class:"subtitle"},ze={key:0,class:"mfa-code-row","data-test":"mfa-row"},Oe={class:"code","data-test":"mfa-code"},Ue=(a=>(te("data-v-06633248"),a=a(),oe(),a))(()=>_("div",{class:"countdown-icon"},null,-1)),$e={class:"countdown","data-test":"mfa-countdown-seconds"},Ne={class:"popover popover-arrow"},Re={class:"option-items"},Ae={key:3,class:"chevron"},Qe=O(U({__name:"LoginListItem",props:{document:{},iconSize:{default:"md"},isParentPopup:{type:Boolean,default:!1},showChevron:{type:Boolean,default:!1}},emits:["showOverlay","editLogin","deleteLogin"],setup(a,{emit:c}){const{sendTelemetry:s,getCurrentTabUrl:v,getCurrentTab:t}=Q(),{t:n}=j(),d=F(),x=q(),k=g(),l=g(),e=a,r=c,y=g(!1),I=g(),P=g(null),L=g(),$=S(()=>{var i;return!!((i=l.value)!=null&&i.code)&&L.value}),A=S(()=>x.currentInfo.flags.showLogInNow&&e.document.type==="login"&&!!e.document.domain&&e.isParentPopup),u=async()=>{var i;L.value=P.value!==null&&_e(P.value),L.value?((i=l.value)==null?void 0:i.timerId)===void 0&&await W({type:"gettotp",uuid:e.document.uuid},l,P.value):Z(l)},p=g({copyUsername:{icon:"copy",id:"copyUsername",title:"pwm_popover_login_copy_username_text.message",callback:()=>ce()},copyPassword:{icon:"copy",id:"copyPassword",title:"pwm_popover_login_copy_password_text.message",callback:()=>re()},copy2fa:{icon:"copy",id:"copy2fa",title:"pwm_popover_login_copy_2fa_text.message",callback:()=>de()},editDetails:{id:"editDetails",icon:"edit",title:"pwm_popover_login_edit_details_text.message",callback:()=>le()},deleteLogin:{icon:"trash",id:"deleteLogin",title:"pwm_popover_login_delete_text.message",cssClass:"delete-button test",callback:()=>pe()}}),E=i=>{const w=i??!y.value;w&&s("pwm_list_login_moremenu_tap"),y.value=w},B=i=>{s(i),E(!1)},M=async i=>{se({text:i,delay:"short"}),r("showOverlay",n("hint_copy_text.message"))},ce=()=>{B("pwm_list_login_moremenu_copy_email"),M(e.document.username)},re=async()=>{const i=await d.getEntryPassword(e.document.uuid);B("pwm_list_login_moremenu_copy_password"),M(i)},de=()=>{var i;B("pwm_list_login_moremenu_copy_2fa"),M((i=l.value)==null?void 0:i.code)},le=()=>{r("editLogin",e.document),B("pwm_list_login_moremenu_edit")},pe=()=>{r("deleteLogin",e.document),B("pwm_list_login_moremenu_delete")};return document.addEventListener("scroll",i=>{u()},{capture:!0}),ee(async()=>{u(),k.value=await v()}),he(()=>{Z(l)}),(i,w)=>{var G,J;return m(),b("div",{class:"item-wrapper login-item",ref_key:"loginItemEl",ref:P,"data-test":"login-item"},[C(ue,{title:i.document.title,domain:i.document.domain,size:i.iconSize},null,8,["title","domain","size"]),_("div",Ee,[_("div",Be,T(i.document.title),1),_("div",De,T(i.document.username),1),o($)?(m(),b("div",ze,[_("div",Oe,T(o(ke)(((G=o(l))==null?void 0:G.code)??"")),1),Ue,_("div",$e,T(((J=o(l))==null?void 0:J.expirySeconds)??""),1)])):f("",!0)]),o(A)?(m(),b("button",{key:0,class:"go-to-website",onClick:[w[0]||(w[0]=K=>(async()=>{const N=await t(),V=Y(e.document.domain);if(N!==void 0&&Ce(V,Y(N.url))){const D=await d.getEntryPassword(e.document.uuid),X=await ae([e.document.uuid]);Te({tabId:N.id,domain:e.document.domain,username:e.document.username},D,X.code),chrome.tabs.update(N.id,{active:!0})}else{const D=await chrome.tabs.create({active:!1,url:V});D.id&&(await new xe().writeAny("oneClickTabDetails",{tabId:D.id,domain:V,uuid:e.document.uuid,username:e.document.username}),chrome.tabs.update(D.id,{active:!0}))}})()),w[1]||(w[1]=H(()=>{},["stop"]))],"data-test":"go-to-website"},[_("div",Ne,T(o(n)("pwm_login_goto_website_text.message")),1)])):f("",!0),i.isParentPopup?(m(),b("button",{key:1,class:"more",onClick:[w[2]||(w[2]=K=>E()),w[3]||(w[3]=H(()=>{},["stop"]))],"data-test":"popover-button",ref_key:"popoverButton",ref:I},null,512)):f("",!0),o(y)?(m(),z(ne,{key:2,direction:"left",onHide:w[4]||(w[4]=K=>E(!1)),"data-test":"popover",targetElement:o(I)},{content:ie(()=>[_("div",Re,[e.document.username?(m(),z(h,{key:0,option:o(p).copyUsername},null,8,["option"])):f("",!0),e.document.passwordStrength?(m(),z(h,{key:1,option:o(p).copyPassword},null,8,["option"])):f("",!0),o($)?(m(),z(h,{key:2,option:o(p).copy2fa},null,8,["option"])):f("",!0),C(h,{option:o(p).editDetails},null,8,["option"]),C(h,{option:o(p).deleteLogin},null,8,["option"])])]),_:1},8,["targetElement"])):f("",!0),i.showChevron?(m(),b("div",Ae)):f("",!0)],512)}}}),[["__scopeId","data-v-06633248"]]),Me=O(U({__name:"CardIcon",props:{cardType:{default:"Other"},size:{default:"sm"}},setup(a){const c=a,s=[{cardType:"AmericanExpress",icon:"amex"},{cardType:"Mastercard",icon:"mastercard"},{cardType:"Visa",icon:"visa"},{cardType:"VisaElectron",icon:"visa-electron"},{cardType:"MaestroUK",icon:"maestro"},{cardType:"Maestro",icon:"maestro"},{cardType:"Jcb",icon:"jcb"},{cardType:"DiscoverCard",icon:"discover"},{cardType:"DinersClubInternational",icon:"diners-club"},{cardType:"DinersClubenRoute",icon:"diners-club"},{cardType:"DinersClubUnitedStatesAndCanada",icon:"diners-club"},{cardType:"Other",icon:"default"}],v=S(()=>{let t;return c.cardType&&(t=s.find(n=>n.cardType===c.cardType),t||(t={cardType:"Other",icon:"default"})),t});return(t,n)=>{var d;return m(),b("div",{class:R(["card-icon",[t.size,(d=o(v))==null?void 0:d.icon]])},null,2)}}}),[["__scopeId","data-v-439ba762"]]),Ve={class:"item-wrapper card"},He={class:"info"},We={class:"title"},je={class:"subtitle"},Ge={class:"option-items"},Je={key:2,class:"chevron"},Ke=U({__name:"CardListItem",props:{document:{},showChevron:{type:Boolean,default:!1},isParentPopup:{type:Boolean,default:!0},iconSize:{default:"md"}},emits:["showOverlay","editCard","deleteCard"],setup(a,{emit:c}){const{sendTelemetry:s}=Q(),{t:v}=j();F();const t=a,n=c,d=g(!1),x=g(),k=S(()=>t.document.cardNumberSuffix&&`•••• ${t.document.cardNumberSuffix}`),l=g({editDetails:{id:"editDetails",icon:"edit",title:"pwm_popover_card_edit_details_text.message",callback:()=>I()},copyNameOnCard:{icon:"copy",id:"copyNameOnCard",title:"pwm_popover_card_copy_name_text.message",callback:()=>P()},copyCardNumber:{icon:"copy",id:"copyCardNumber",title:"pwm_popover_card_copy_card_number_text.message",callback:()=>L()},copySecurityCode:{icon:"copy",id:"copySecurityCode",title:"pwm_popover_card_copy_security_code_text.message",callback:()=>$()},deleteCard:{icon:"trash",id:"deleteCard",title:"pwm_popover_card_delete_text.message",cssClass:"delete-button test",callback:()=>A()}}),e=u=>{const p=u??!d.value;p&&s("pwm_list_card_moremenu_tap"),d.value=p},r=u=>{s(u),e(!1)},y=async u=>{let p;u.sourceType==="document"?p=t.document[u.source]?String(t.document[u.source]):"":p=(await Ie([t.document.uuid]))[u.source],p&&(se({text:p,delay:"short"}),n("showOverlay",u.message))},I=()=>{n("editCard",t.document),r("pwm_list_card_moremenu_edit")},P=()=>{r("pwm_list_card_moremenu_copy_name"),y({sourceType:"document",source:"name",message:v("hint_copy_text.message")})},L=()=>{r("pwm_list_card_moremenu_copy_number"),y({sourceType:"cardBody",source:"n",message:v("hint_copy_text.message")})},$=()=>{r("pwm_list_card_moremenu_copy_code"),y({sourceType:"cardBody",source:"sc",message:v("hint_copy_text.message")})},A=()=>{n("deleteCard",t.document),r("pwm_list_card_moremenu_delete")};return(u,p)=>(m(),b("div",Ve,[C(Me,{cardType:u.document.cardType,size:u.iconSize},null,8,["cardType","size"]),_("div",He,[_("div",We,T(u.document.title),1),_("div",je,T(o(k)),1)]),u.isParentPopup?(m(),b("button",{key:0,class:"more",onClick:[p[0]||(p[0]=E=>e()),p[1]||(p[1]=H(()=>{},["stop"]))],"data-test":"popover-button",ref_key:"cardPopoverButton",ref:x},null,512)):f("",!0),o(d)?(m(),z(ne,{key:1,direction:"left",onHide:p[2]||(p[2]=E=>e(!1)),"data-test":"popover",targetElement:o(x)},{content:ie(()=>[_("div",Ge,[C(h,{option:o(l).editDetails},null,8,["option"]),C(h,{option:o(l).copyNameOnCard},null,8,["option"]),C(h,{option:o(l).copyCardNumber},null,8,["option"]),C(h,{option:o(l).copySecurityCode},null,8,["option"]),C(h,{option:o(l).deleteCard},null,8,["option"])])]),_:1},8,["targetElement"])):f("",!0),u.showChevron?(m(),b("div",Je)):f("",!0)]))}}),et=O(Ke,[["__scopeId","data-v-7e2df768"]]);export{h as C,Qe as L,ne as P,W as a,Me as b,et as c,Z as k};
