import"./modulepreload-polyfill-xVUEmHkd.js";import{_ as P,d as K}from"./_plugin-vue_export-helper-DbWluJVK.js";import{c as G,p as Q,a as ee,f as ae}from"./unhandledErrorHandler-Bxfeq5I8.js";import{i as se}from"./i18n-DOZcdwWT.js";import{T as le}from"./Tabs-BUnkJjvo.js";import{B as te}from"./BaseHeader-DOsPTEtD.js";import{W as M}from"./WebsiteIcon-DpK2IMEY.js";import{B as V}from"./Button-BiW9ff6I.js";import{T as k,P as E}from"./TextInput-BKjIqiTR.js";import{U as D,V as B,a2 as c,a3 as ie,W as _,X as x,Y as g,$ as d,Z as a,a7 as y,ag as ne,_ as j,a5 as I,aa as oe,ab as ue,a8 as de,ai as me,a4 as L,a6 as X,a0 as q,am as H,aG as re,a9 as ve,e as R,aY as Y,aZ as Z}from"./Settings-Bqkr9m9-.js";import{D as pe}from"./DocumentsListItem-DGb2b7it.js";import{d as ce,s as we,e as _e}from"./autofillFunctions-CVxus-se.js";import{a as be}from"./AutofillMessageHandler-0g4xScxK.js";import"./CardListItem-DEPKb1tk.js";import"./isVisible-D3ksDT_w.js";const ge={class:"document-preview"},fe={class:"top-section"},ye=P(D({__name:"CreateNewDocument",props:{title:{default:""},username:{default:""},password:{default:""},domain:{default:""}},emits:["saved"],setup(p,{emit:b}){const{t}=B(),w=G(),v=b,s=p,i=c(s.title),m=c(s.username),r=c(s.password);return ie(s,o=>{i.value=o.title,m.value=o.username,r.value=o.password}),(o,l)=>(_(),x("div",ge,[g("div",fe,[d(M,{class:"mr-20",domain:o.domain,title:a(i),size:"md"},null,8,["domain","title"]),d(k,{id:"create-name",label:a(t)("pwm_entry_preview_name_label.message"),value:a(i),"onUpdate:value":l[0]||(l[0]=e=>y(i)?i.value=e:null)},null,8,["label","value"])]),d(k,{id:"create-email",label:a(t)("pwm_entry_view_email_label.message"),value:a(m),"onUpdate:value":l[1]||(l[1]=e=>y(m)?m.value=e:null)},null,8,["label","value"]),d(E,{id:"create-password",label:a(t)("pwm_entry_view_pw_label.message"),value:a(r),"onUpdate:value":l[2]||(l[2]=e=>y(r)?r.value=e:null),"show-eye":!0,"show-eye-when-empty":!0},null,8,["label","value"]),d(V,{label:a(t)("pwm_entry_view_save_btn.message"),id:"saveNewBtn",size:"sm",onClick:l[3]||(l[3]=e=>(async()=>{const h={title:i.value,username:m.value,password:r.value,domain:s.domain};await w.addEntry(h).then(()=>{v("saved")})})())},null,8,["label"])]))}}),[["__scopeId","data-v-12cbbfee"]]),he={class:"update-document"},ke=(p=>(oe("data-v-f4b52705"),p=p(),ue(),p))(()=>g("div",{class:"icon"},null,-1)),xe={class:"label"},Ue={class:"existing-document"},Ce={class:"top-section mb-15"},Le={class:"new-document"},De=P(D({__name:"UpdateExistingDocument",props:{newUsername:{default:""},newPassword:{default:""},title:{default:""},username:{default:""},password:{default:""},domain:{default:""},uuid:{default:""}},emits:["saved","back"],setup(p,{emit:b}){const{t}=B(),w=G(),v=b,s=p,i=c(s.newUsername),m=c(s.newPassword||s.password);return(r,o)=>{const l=ne("i18n-t");return _(),x("div",he,[g("div",{class:"navigation",onClick:o[0]||(o[0]=e=>{v("back")})},[ke,g("div",xe,j(a(t)("back.message")),1)]),g("div",Ue,[g("div",Ce,[d(M,{class:"mr-10",domain:r.domain,title:r.title,size:"md"},null,8,["domain","title"]),d(k,{class:"ml-15 mt-10",id:"update-name",label:a(t)("pwm_entry_preview_name_label.message"),value:r.title,disabled:""},null,8,["label","value"])]),d(k,{id:"update-email",label:a(t)("pwm_entry_view_email_label.message"),value:r.username,disabled:""},null,8,["label","value"]),d(E,{class:"visible-margin",id:"update-password",label:a(t)("pwm_entry_view_pw_label.message"),value:r.password,"show-eye":!0,"fixed-mask-size":!0,"fixed-dots":20,disabled:!0},null,8,["label","value"])]),g("div",Le,[d(l,{class:"pt-15",tag:"p",keypath:"autosave_modal_update_prompt_header.message",scope:"global"},{HOST:I(()=>[g("b",null,j(r.title),1)]),_:1}),d(k,{id:"new-email",label:a(t)("pwm_entry_view_email_label.message"),value:a(i),"onUpdate:value":o[1]||(o[1]=e=>y(i)?i.value=e:null)},null,8,["label","value"]),d(E,{class:"visible-margin",id:"new-password",label:a(t)("pwm_entry_view_pw_label.message"),value:a(m),"onUpdate:value":o[2]||(o[2]=e=>y(m)?m.value=e:null),"show-eye":!0,"fixed-mask-size":!0,"fixed-dots":20},null,8,["label","value"]),d(V,{label:a(t)("update_btn_label.message"),id:"saveNewBtn",size:"sm",onClick:o[3]||(o[3]=e=>(()=>{const h={title:s.title,username:i.value||s.username,password:m.value||s.password,domain:s.domain,uuid:s.uuid};w.updateEntry(h).then(()=>{v("saved")})})())},null,8,["label"])])])}}}),[["__scopeId","data-v-f4b52705"]]),Te={class:"existing-entries-list"},ze=P(D({__name:"ExistingDocumentList",props:{savedDocuments:{type:Array,default:void 0,required:!0}},emits:["click"],setup(p,{emit:b}){const t=b;return(w,v)=>(_(),x("div",Te,[p.savedDocuments?(_(!0),x(de,{key:0},me(p.savedDocuments,s=>(_(),L(pe,{onClick:i=>(m=>{t("click",m)})(s),key:s.uuid,document:s,showChevron:""},null,8,["onClick","document"]))),128)):X("",!0)]))}}),[["__scopeId","data-v-eb7469b7"]]),Ee={class:"autosave-app"},Ie=D({__name:"AutosaveApp",setup(p){const{t:b}=B(),t=c(),w=c(!1),v=c(!1),s=c([]),i=c("newLogin"),m=[{id:"newLogin",title:b("autosave_new_login_tab.message")},{id:"existingLogin",title:b("autosave_existing_login_tab.message")}],r=q(()=>v.value||s.value.length===0),o=q(()=>{let n="autosave_modal_save_prompt_title.message";switch(i.value){case"newLogin":n=w.value?"autosave_modal_saved_title.message":"autosave_modal_save_prompt_title.message";break;case"existingLogin":n=w.value?"autosave_modal_updated_title.message":v.value?"autosave_modal_update_prompt_title.message":"autosave_modal_choose_entry_title.message"}return n}),l=H({title:"",username:"",password:"",domain:""}),e=H({title:"",username:"",password:"",domain:"",uuid:""}),h=new URLSearchParams(window.location.search),U=parseInt(h.get("frameId"),10);re(()=>{chrome.tabs.query({active:!0,currentWindow:!0},async n=>{if(n){t.value=n[0].id;const u=be(),f=(await Q({tab:n[0],associatedDomains:u})).domainLoginItems;s.value=f}})}),ve(()=>{ce().then(n=>{var u,f,A,N;if(n){const T=n.fields,C=n.url,{exactLoginDifferentPasswordExists:J,matchingEntry:O}=n.credentialsMatch??{};l.username=(f=(u=T.login)==null?void 0:u.find(z=>z.inputType==="username"))==null?void 0:f.value,l.password=(N=(A=T.login)==null?void 0:A.find(z=>z.inputType==="password"))==null?void 0:N.value,l.title=R(C)??C;const W=R(C);if(W===null)throw new Error("Invalid url, cannot get domain: "+C);l.domain=W,T.login&&J&&O&&(Object.assign(e,O),i.value="existingLogin",v.value=!0)}}),new ResizeObserver(n=>{Y(t.value,U,{height:n[0].target.clientHeight})}).observe(document.body)});const $=()=>{we(!1),Z(t.value,U)},S=async()=>{Y(t.value,U,{height:55}),w.value=!0,setTimeout(()=>{_e(),Z(t.value,U)},5e3)},F=n=>{switch(n.type){case"login":{const u=n;e.username=u.username,e.password=u.password,e.title=u.title,e.domain=u.domain,e.uuid=u.uuid,v.value=!0;break}}};return(n,u)=>(_(),x("div",Ee,[d(te,{text:a(o),onClose:$,title:l.title},null,8,["text","title"]),a(w)?X("",!0):(_(),L(le,{key:0,value:a(i),"onUpdate:value":u[1]||(u[1]=f=>y(i)?i.value=f:null),allTabs:m,customClass:{hideTabs:a(r)}},{newLogin:I(()=>[d(ye,{title:l.title,username:l.username,domain:l.domain,password:l.password,onSaved:S},null,8,["title","username","domain","password"])]),existingLogin:I(()=>[a(v)?(_(),L(De,{key:1,newUsername:l.username,newPassword:l.password,title:e.title,username:e.username,domain:e.domain,password:e.password,uuid:e.uuid,onSaved:S,onBack:u[0]||(u[0]=f=>v.value=!1)},null,8,["newUsername","newPassword","title","username","domain","password","uuid"])):(_(),L(ze,{key:0,savedDocuments:a(s),onClick:F},null,8,["savedDocuments"]))]),_:1},8,["value","customClass"]))]))}});ee("autoSave"),K(Ie).use(se).use(ae()).mount("#app");
